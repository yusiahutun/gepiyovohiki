<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>How to Scan for Kubernetes Vulnerabilities With Kubescape | WinkVlog</title><meta name=generator content="Hugo 0.98.0"><meta name=description content="Quick LinksDownloading Kubescape  Scanning Your Cluster  Scan Results  Scanning Manifest Files  Offline Scans  Output Formats  Conclusion   Kubescape is a new open-source tool from ARMO which lets you automate Kubernetes cluster scans to identify security issues. Kubescape audits your cluster against the hardening recommendations published by the NSA and CISA.
  Here's how to install Kubescape and get started scanning your cluster."><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/normalize.css><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel=stylesheet type=text/css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/cayman.css><link rel=apple-touch-icon sizes=180x180 href=./apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=./favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=./favicon-16x16.png><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css integrity=sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js integrity=sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><section class=page-header><h1 class=project-name>WinkVlog</h1><h2 class=project-tagline></h2><nav><a href=./index.html class=btn>Blog</a>
<a href=./sitemap.xml class=btn>Sitemap</a>
<a href=./index.xml class=btn>RSS</a></nav></section><section class=main-content><h1>How to Scan for Kubernetes Vulnerabilities With Kubescape</h1><div><strong>Publish date: </strong>2024-08-14</div><h3>Quick Links</h3><ul class=table-content-level-1><li><a href=#>Downloading Kubescape</a></li></ul><ul class=table-content-level-1><li><a href=#>Scanning Your Cluster</a></li></ul><ul class=table-content-level-1><li><a href=#>Scan Results</a></li></ul><ul class=table-content-level-1><li><a href=#>Scanning Manifest Files</a></li></ul><ul class=table-content-level-1><li><a href=#>Offline Scans</a></li></ul><ul class=table-content-level-1><li><a href=#>Output Formats</a></li></ul><ul class=table-content-level-1><li><a href=#>Conclusion</a></li></ul><p>Kubescape is a new <a href=#>open-source tool</a> from ARMO which lets you automate Kubernetes cluster scans to identify security issues. Kubescape audits your cluster against the hardening recommendations published by the <a href=#>NSA and CISA</a>.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Here's how to install Kubescape and get started scanning your cluster. Regular scans could help you resolve issues before they're utilized by attackers.</p><h2 id=downloading-kubescape>Downloading Kubescape</h2><p>Kubescape is currently distributed as a pre-built binary for Windows, macOS and Ubuntu. You can download it directly from the <a href=#>project's GitHub releases page</a>.</p><p>There's also an automated install script that you can paste into your terminal. This will fetch the correct binary for your system and add it to your path.</p><pre>curl -s https://raw.githubusercontent.com/armosec/kubescape/master/install.sh | /bin/bash</pre><p>Try running <code>kubescape</code> to check installation is complete. You'll see a synopsis of the available commands.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2021/09/2dddfdcc.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=scanning-your-cluster>Scanning Your Cluster</h2><p>Kubernetes connects to your cluster using standard <a href=#>Kubectl config files</a>. Set the <code>KUBECONFIG</code> environment variable in your shell to reference the config file for the cluster you want to scan:</p><pre>export KUBECONFIG=.kube/my-cluster.yaml</pre><p>Kubescape will complain that it "failed to load Kubernetes config" if this variable's not set or the specified file is invalid. Update the <code>KUBECONFIG</code> variable each time you execute Kubescape if you want to scan multiple clusters.</p><p>Scans are initiated with the <code>scan</code> command. You need to indicate the hardening framework you want to scan against. Currently <code>nsa</code> is the only supported option.</p><pre>kubescape scan framework nsa --exclude-namespaces kube-system,kube-public</pre><p>Kubescape will scan all the resources in your cluster, except for resources in namespaces omitted by the <code>--exclude-namespaces</code> flag. It's recommended you list the built-in Kubernetes namespaces here as you won't be able to address any issues which are found.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong> <img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2021/09/38e395b3.png><p>Your first Kubescape scan might take some time as the tool needs to download its framework definitions. These define the tests your cluster is scored against. Once the scan's complete, you'll see colorized output in your terminal that details any discovered issues.</p><h2 id=scan-results>Scan Results</h2><p>Each failed test produces its own section of output with a list of the suspect resources, a description of the problem, and a remediation hint. A table at the bottom of the report provides a summary of all the executed tests, the number of resources that failed them, and the overall success percentage.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong> <img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2021/09/0ce3161e.png><p>Kubescape checks over 20 possible weaknesses based on the NSA-identified list. The <a href=#>NSA's report</a> provides a description of the covered issues and the rationale for their inclusion. Some of the key problems which Kubescape checks for include:</p><ul><li>Privilege escalation opportunities</li><li>Containers running in privileged mode</li><li>Containers running with dangerous capabilities</li><li>Exposed <a href=#>Kubernetes Dashboard</a></li><li>Containers running as <code>root</code></li><li>Credentials contained in configuration files</li><li>Incorrectly secured control plane</li></ul><p>Running Kubescape lets you check your cluster's health against the current best practice guidelines, giving you more confidence that you're not putting your data and workloads at risk.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=scanning-manifest-files>Scanning Manifest Files</h2><p>Kubescape can work without a cluster connection. You can scan resource manifests stored as local YAML files, letting you check their security before you apply them to your cluster. Add an extra argument after the framework name to specify the files you want to scan:</p><pre>kubescape scan framework nsa k8s/*.yaml</pre><p>You can use a URL as the file path to scan files stored remotely, such as in a Git repository.</p><p>It's best to use the default cluster scanning mode when you're conducting a comprehensive security audit. Manifest scans are ideally incorporated into CI pipelines. Used in this way, you can avoid unintentionally introducing new vulnerabilities as you update your resources and roll them out to your cluster.</p><h2 id=offline-scans>Offline Scans</h2><p>Kubescape is designed for online use as it needs to download the framework definitions before it can complete a scan. You can manually save the framework though to facilitate offline scans. You should try to update the file periodically so it doesn't become outdated.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Download the NSA framework file:</p><pre>kubescape download framework nsa --output nsa.json</pre><p>Now scan your cluster using the downloaded file:</p><pre>kubescape scan framework nsa --use-from nsa.json</pre><p>The <code>--use-from</code> flag instructs Kubescape to load framework definitions from the specified file. There's also <code>--use-default</code> which will try to use the locally cached file in the default location when it's available. Kubescape falls back to downloading the latest definitions from the server when no file is found.</p><h2 id=output-formats>Output Formats</h2><p>Kubescape outputs to your terminal by default but can also produce reports in JSON or Junit format. Add the <code>-f</code> flag to specify your desired mode:</p><pre>kubescape scan framework nsa -f json  <p>kubescape scan framework nsa -f junit</p></pre><p>The latter option emits an XML file which can be consumed by test report tools that work with the Junit format. This lets you feed Kubescape scans into your existing test reporting solutions for visualization and aggregation.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Output is emitted to your terminal's standard output stream irrespective of the report format you specify. Add the <code>-o</code> flag to supply a file path to save to:</p><pre>kubescape scan framework nsa -f json -o report.json</pre><p>Kubescape's usual progress messages can be disabled with the <code>-s</code> flag. This is helpful in CI scenarios where you don't want to pollute job logs with ASCII characters.</p><h2 id=conclusion>Conclusion</h2><p>Kubescape lets you assess the safety of your Kubernetes clusters against the guidelines published by the NSA. The simple open-source tool provides a single command to benchmark your environment against over 20 key checks.</p><p>Kubescape doesn't check for vulnerabilities inside the containers you run in your cluster. You'll need another tool such as <a href=#><code>docker scan</code></a> or <a href=#>Trivy</a> to do that. Running a container scanning engine alongside Kubescape gives you the most complete picture of your environment's security posture.</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGibnq6fpcBwtM6wZK2nXaiworqMn6arZZuqr6a%2BzZ6rnqtdq8KtusSrmJuhnJ7BqrHSZq6irJhiuLauxKyamqiVZA%3D%3D</p><footer class=site-footer><span class=site-footer-credits>Made with <a href=https://gohugo.io/>Hugo</a>. Â© 2022. All rights reserved.</span></footer></section><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>